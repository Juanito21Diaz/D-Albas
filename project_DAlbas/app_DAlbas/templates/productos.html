{% extends "index.html" %}

{% block encabezado %}
{% include "encabezado.html" %}
{% endblock %}

{% block contenido %}

<section class="products" id="products" href="/productos/">
    <h1 class="heading" name="pastillaje">Nuestros <span> Productos</span></h1>
    <div class="row">
        <div class="col-12 col-md-8 order-sm-2">
            <div id="primary" class="content-area">
                <main id="main" class="site-main" role="main">
                    <div class="col product-slider row">
                        {% for producto in listaProductos %}
                        <div class="col-sm-5 h-30 box m-3"
                            data-categoria="{{producto.categoriaProducto.nombreCategoria}}"
                            data-tematica="{{producto.tematicaProducto.nombreTematica}}">
                            <img src="../media/{{producto.imagenProducto}}" class=" card-img-top"
                                alt="{{ product.nombreProducto }}">
                            <div class="card-body">
                                <!-- <h3 class="card-title">{{producto.nombreProducto}}</h3> -->
                                <div class="d-flex align-items-center justify-content-center pix-pb-202 nombreProducto">
                                    <h3 class="card-title">{{producto.nombreProducto}}</h3>
                                    <button type="button" class="btn px-2 py-2 pix-add-to-wishlist" data-toggle="modal"
                                        data-target="#modalProducto{{producto.id}}">
                                        <div class="fas fa-eye" id="login-btn"></div>
                                    </button>
                                </div>
                                <div class="price">{{producto.descripcionProducto}}</div>
                            </div>
                            <div class="d-flex align-items-center pix-pb-202">
                                <div class="flex-fill">
                                    <div class="pix-product-price">
                                        <span class="price font-weight-bold mb-0">
                                            <span class="woocommerce-Price-amount amount">
                                                <bdi class="precio" style="padding-left: 30px;">
                                                    $ {{producto.precioProducto}}
                                                </bdi>
                                            </span>
                                        </span>
                                    </div>
                                    <div class="pix-product-rating"></div>
                                </div>
                                <div class="btn pix-pl-10 align-self-stretch d-flex">
                                    <a href="{% url 'Add' producto.id %}" class="pix-add-to-wishlist">
                                        <div class="fas fa-shopping-cart" id="login-btn"></div>
                                    </a>
                                </div>
                                <div class="btn mx-2" onclick="abrirModalQR('{{ producto.qrProducto.url }}')">
                                    <div class=" fa fa-qrcode fa-2x"></div>
                                </div>
                            </div>
                        </div>

                        <div class=" modal fade modalProductos" id="modalProducto{{producto.id}}" tabindex="-1"
                            role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                                <div class="modal-content rounded-0">
                                    <div class="modal-body py-0">

                                        <div class="d-flex main-content">
                                            <div class="bg-image promo-img mr-3"
                                                style="background-image: url('/media/{{producto.imagenProducto}}');">
                                                <span class="price">${{producto.precioProducto}}</span>
                                            </div>
                                            <div class="content-text p-4 px-5 align-item-stretch">
                                                <div class="text-center">
                                                    <a href="#" class="share"><span class="icon-share"></span></a>
                                                    <h3 class="mb-3 line">{{producto.nombreProducto}}
                                                    </h3>
                                                    <p class="mb-3">
                                                        <span class="icon-star text-warning"></span>
                                                        <span class="icon-star text-warning"></span>
                                                        <span class="icon-star text-warning"></span>
                                                        <span class="icon-star text-warning"></span>
                                                        <span class="icon-star"></span>
                                                    </p>

                                                    <p class="mb-5">{{producto.descripcionProducto}}</p>
                                                    <p class="mb-5">Sabor: {{producto.saborProducto}}
                                                    </p>
                                                    <p class="mb-5">{{producto.unidadMedidaProducto}}
                                                    </p>
                                                    <p class="mb-5">{{producto.categoriaProducto}}</p>
                                                    <p class="mb-5">${{producto.precioProducto}}</p>

                                                    <div class="d-flex text-center social w-50 mx-auto">
                                                        <a href="#"
                                                            class="d-inline-block d-flex align-items-center mr-auto like">
                                                            <span class="icon-heart mr-2 icon"></span>
                                                            <span>25</span>
                                                        </a>
                                                        <a href="#"
                                                            class="d-inline-block d-flex align-items-center mx-auto message">
                                                            <span class="icon-chat mr-2 icon"></span>
                                                            <span>10</span>
                                                        </a>
                                                        <a href="#"
                                                            class="d-inline-block d-flex align-items-center ml-auto add">
                                                            <span class="icon-add mr-2"></span>
                                                            <span>55</span>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </main>
            </div>
        </div>

        <div class="sidebar col-12 col-md-4 order-md-1 order-sm-1" style="position: relative; z-index:10;">
            <div class="w-100 h-100 d-flex align-items-start" style="z-index:10;">
                <aside id="secondary"
                    class="widget-area sticky-bottom pix-sticky-sidebar pix-boxed-widgets w-100 pix-pb-30 pix-sidebar-adjust">
                    <section id="woocommerce_product_categories-1" class="widget woocommerce widget_product_categories">
                        <h3 class="font-weight-bold text-heading-default widget-title2 pix-mb-10"
                            style="font-size: 2rem;">
                            Catálogo</h3>
                        <ul class="product-categories list-unstyled">
                            <li class="cat-item cat-item-88 cat-parent"><a href="#" id="todosTemas">Temáticas</a><span
                                    class="count">7</span>
                                <ul class="children">
                                    <li class="cat-item cat-item-253"><a href="#" id="cumpleaños">Cumpleaños</a> <span
                                            class="count">{{ Cumpleaños }}</span></li>
                                    <li class="cat-item cat-item-253"><a href="#" id="bautizos">Bautizos</a> <span
                                            class="count">{{ Bautizos }}</span></li>
                                    <li class="cat-item cat-item-253"><a href="#" id="primeraComunion">Primera
                                            comunion</a> <span class="count">{{ Primera_comunion }}</span></li>
                                    <li class="cat-item cat-item-253"><a href="#" id="grados">Grados</a> <span
                                            class="count">{{ Grados }}</span></li>
                                    <li class="cat-item cat-item-253"><a href="#" id="matrimonios">Matrimonios</a> <span
                                            class="count">{{ Matrimonios }}</span></li>
                                    <li class="cat-item cat-item-253"><a href="#" id="aniversarios">Aniversarios</a>
                                        <span class="count">{{ Aniversarios }}</span>
                                    </li>
                                    <li class="cat-item cat-item-253"><a href="#" id="quinces">Quinces</a> <span
                                            class="count">{{ Quinces }}</span></li>
                                </ul>
                            </li>
                            <li class="cat-item cat-item-89 current-cat cat-parent"><a href="#"
                                    id="todos">Categoría</a><span class="count">4</span>
                                <ul class="children">
                                    <li class="cat-item cat-item-109"><a href="#" id="tortasCrema">Tortas en Crema</a>
                                        <span class="count">{{ Tortas_en_crema }}</span>
                                    </li>
                                    <li class="cat-item cat-item-95"><a href="#" id="tortasPastillaje">Tortas en
                                            Pastillaje</a> <span class="count">{{ Tortas_en_pastillaje }}</span></li>
                                    <li class="cat-item cat-item-96"><a href="#" id="cupcakes">Cupcakes</a> <span
                                            class="count">{{ Cupcakes }}</span></li>
                                    <li class="cat-item cat-item-93"><a href="#" id="galletas">Galletas</a> <span
                                            class="count">{{ Galletas }}</span></li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </aside>
            </div>
        </div>
    </div>
</section>
<script>
    function abrirModalQR(urlImagen) {
        Swal.fire({
            title: "D'Albas - Código QR",
            text: 'Escanea el código QR para obtener más información sobre este delicioso producto de nuestra pastelería.',
            imageUrl: urlImagen,
            imageWidth: 300,
            imageHeight: 300,
            imageAlt: 'Código QR',
            confirmButtonText: 'Cerrar'
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
        var precios = document.querySelectorAll('.precio');
        precios.forEach(function (precio) {
            var precioSinFormato = precio.textContent.split('$ ')[1];
            var precioFormateado = parseFloat(precioSinFormato).toLocaleString('es-CO', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 2 
            }); 

            precio.textContent = '$ ' + precioFormateado;
        });
    });

</script>
{% endblock %}

{% block footer %}
{% include "footer.html" %}
{% endblock %}